---
layout: post
title: extracting & preparing geographical data
---

1. to get tgn numbers and theire frequencies (correlating with date - for each issue frequencies of tgn-numbers):

```
	import re, os

	source = "/Users/susanna/Documents/Studien/MA Zeitgeschichte & Medien/3.Sem/tools and techniques/scraping/Richmond-Times/"

	lof = os.listdir(source)
	counter = 0 

	placeFrequencies = {}

	for f in lof:
	    if f.startswith("dltext"): # fileName test

		print(source+f)     
		with open(source + f, "r", encoding="utf8") as f1:
		    text = f1.read()

		    # find the date
		    counter += 1
		    date = re.search(r'<date value="([\d-]+)"', text).group(1)+','+str(counter)


		    placeNames = re.findall(r'<placeName([^<]+)</placeName>', text)
		    print(len(placeNames))

		    counter1 = 0
		    for p in placeNames:
			if re.search(r'tgn,(\d+)', p):
				tgn = re.search(r'tgn,(\d+)', p).group(1)

				tgn = tgn+','+date

				if tgn in placeFrequencies:
					placeFrequencies[tgn] += 1
				else:
					placeFrequencies[tgn] = 1

			else:
				counter1 = counter1 + 1
		    #print(counter)
		    #input()


	# convert dic to list, how does dic know key and value?
	finalTable = []

	for k,v in placeFrequencies.items():
		temp = k+','+str(v)
		finalTable.append(temp)

	#final = '\n'.join(finalTable)
	#input(final)

	with open("places.csv", "w", encoding="utf8") as f9:
		f9.write("\n".join(finalTable))


```

credits: Maxim Romanov
 
csv file - tgn numbers, date, issue counter, frequency

 ![screenshot file tgn and frequencies][1]
 
 
 [1]: https://raw.githubusercontent.com/suszette/suszette.github.io/master/img/Bildschirmfoto%202020-01-13%20um%2013.09.30.png
 


2. attempt to write a script to work with the data set of Getty Thesaurus of Geographic Names (a 30+ GB file, sublime text crashed while trying to open file):

```
	import re, os

	source = "/Volumes/euterpe/full/"
	source2 = "/Users/susanna/Documents/Studien/MA Zeitgeschichte & Medien/3.Sem/tools and techniques/places.csv"

	lof = os.listdir(source)
	counter = 0 

	lonlat = {}

	for f in lof:
	    if f.startswith("TGNOut_Full"): # fileName test

		print(source+f)     
		with open(source + f, "r", encoding="utf8") as f1:
		    text = f1.read()


		    tgn = re.findall(r'tgn,(\d+)', text).group(1)

		    with open(source2 + f, "r", encoding="utf8") as f2:
		    text2 = f2.read()


		    if tgn in source2:
					tgn += 1

			    for lon in tgn:
				lon = re.search(r'<____="(____)"', text).group(2)

			    for lat in tgn:
				lat = re.search(r'<____="(____)"', text).group(2)


					v = str(lon, lat)

	finalTable = []

	for k,v in lonlat.items():
		temp = str(k)+','+v
		finalTable.append(temp)

	with open("lonlat.csv", "w", encoding="utf8") as f9:
		f9.write("\n".join(finalTable))
            		
```
